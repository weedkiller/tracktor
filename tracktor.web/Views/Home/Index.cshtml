<div class="jumbotron">
    <h1>ASP.NET</h1>
    <p class="lead">ASP.NET is a free web framework for building great Web sites and Web applications using HTML, CSS, and JavaScript.</p>
    <p><a href="http://asp.net" class="btn btn-primary btn-lg">Learn more &raquo;</a></p>
</div>
<div class="row">
    <div class="col-md-4">
        <h2>Getting started</h2>
        <p>ASP.NET Web API is a framework that makes it easy to build HTTP services that reach
        a broad range of clients, including browsers and mobile devices. ASP.NET Web API
        is an ideal platform for building RESTful applications on the .NET Framework.</p>
        <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301870">Learn more &raquo;</a></p>
    </div>
    <div class="col-md-4">
        <h2>Get more libraries</h2>
        <p>NuGet is a free Visual Studio extension that makes it easy to add, remove, and update libraries and tools in Visual Studio projects.</p>
        <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301871">Learn more &raquo;</a></p>
    </div>
    <div class="col-md-4">
        <h2>Web Hosting</h2>
        <p>You can easily find a web hosting company that offers the right mix of features and price for your applications.</p>
        <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301872">Learn more &raquo;</a></p>
    </div>
</div>
<h3>Register</h3>
    @using (Html.BeginForm("Register", "api/Account", FormMethod.Post))
    {
        <input type="text" name="Email" />
        <input type="text" name="TimeZone" />
        <input type="text" name="Password" />
        <input type="text" name="ConfirmPassword" />
        <input type="submit" value="register" />
    }
<h3>Sign In</h3>
<form action="@Url.Action("", "Token")" method="post" id="loginform">
        <input type="text" name="UserName" id="username"/>
        <input type="text" name="Password" id="password"/>
        <input type="hidden" name="grant_type" value="password" />
</form>

<button onclick="login();" title="Login">Login</button>

<p>Token: <span id="token"></span></p>

<h3>Test</h3>
<form action="@Url.Action("GetModel", "api/Tracktor")" method="post" id="testform">
    <input type="text" name="UserName" />
    <input type="text" name="Password" />
    <input type="hidden" name="grant_type" value="password" />
</form>

<button onclick="testApi();" title="Test">Test</button>


<script type="text/javascript">

    var tokenKey = "TokenKey";

    var login = function() {
        var loginData = {
            grant_type: 'password',
            username: $('#username').val(),
            password: $('#password').val()
        };

        $.ajax({
            type: 'POST',
            url: '/Token',
            data: loginData
        }).done(function (data) {
            alert(data.userName);
            // Cache the access token in session storage.
            sessionStorage.setItem(tokenKey, data.access_token);
            $('#token').val(data.access_token);
        });
    }

    var testApi = function () {
        var token = sessionStorage.getItem(tokenKey);
        var headers = {};
        if (token) {
            headers.Authorization = 'Bearer ' + token;
        }

        $.ajax({
            type: 'GET',
            url: 'api/Tracktor/GetModel',
            headers: headers
        }).done(function (data) {
            alert(data);
        });
    }
</script>
